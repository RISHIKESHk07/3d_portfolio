
faqs = """
phrase
Can we go for a walk?
Can you stay here with me?
Please help me get dressed.
I want to draw something.
I want to talk to someone.
Call the doctor.
Can you check my temperature?
I need some water.
Please adjust my pillow.
Can you help me write something?
I need to use the restroom.
I want to talk to someone.
Thank you for helping me.
Can you stay here with me?
Can you check my temperature?
I feel a bit lonely.
Can you check my temperature?
Please help me get dressed.
Call the doctor.
I would like to have breakfast.
Can you help me write something?
I would like some tea.
Please cover me with a blanket.
Can you help me write something?
Call the doctor.
I would like to have breakfast.
I feel a bit lonely.
Please adjust my pillow.
I feel uncomfortable.
I need some water.
I need my medicine.
I feel a bit lonely.
Good morning!
I need to use the restroom.
Good morning!
Good night!
I would like some tea.
I need some water.
Can you read me a story?
I need some water.
Good morning!
I want to draw something.
I would like to have breakfast.
I want to talk to someone.
Can we go for a walk?
Can you help me write something?
Please adjust my pillow.
I need to use the restroom.
Call the doctor.
Good morning!
I want to talk to someone.
Can you check my temperature?
Please help me get dressed.
I need to use the restroom.
I am feeling tired.
I am feeling happy.
I need to use the restroom.
Can you help me write something?
I am feeling tired.
Can you check my temperature?
I feel a bit lonely.
Please help me get dressed.
I am feeling happy.
Call the doctor.
Can we go for a walk?
I would like to have breakfast.
Can you help me write something?
I am feeling happy.
Please fix my hair.
I want to talk to someone.
Can we go for a walk?
Can you check my temperature?
I am feeling happy.
Please help me get dressed.
I need to use the restroom.
Thank you for helping me.
I want to talk to someone.
I feel uncomfortable.
I need my medicine.
I am feeling tired.
Can you read me a story?
I am feeling happy.
I want to draw something.
Can you help me write something?
Please fix my hair.
Can we go for a walk?
Good morning!
I would like some tea.
I want to draw something.
I need my medicine.
I need some water.
I need my medicine.
Good morning!
Can you help me write something?
Please fix my hair.
I would like to have breakfast.
Please fix my hair.
Can we go for a walk?
Good morning!
I need some water.
Can you read me a story?
Please fix my hair.
I would like to have breakfast.
Please help me get dressed.
Can you help me write something?
Can we go for a walk?
Good morning!
Please adjust my pillow.
Please fix my hair.
I would like to have breakfast.
I would like to have breakfast.
I want to talk to someone.
Please fix my hair.
Thank you for helping me.
Can you check my temperature?
I need my medicine.
Call the doctor.
I need my medicine.
Please help me get dressed.
Thank you for helping me.
I need some water.
I would like to have breakfast.
I feel uncomfortable.
I feel a bit lonely.
I am ready for bed.
Please adjust my pillow.
Can you stay here with me?
Can you help me write something?
Please adjust my pillow.
I feel a bit lonely.
Good morning!
Please cover me with a blanket.
I am feeling tired.
Can you read me a story?
I am feeling happy.
Thank you for helping me.
Please adjust my pillow.
I feel a bit lonely.
I want to draw something.
I feel uncomfortable.
I am feeling tired.
Please fix my hair.
I need my medicine.
Please fix my hair.
Call the doctor.
I would like to have breakfast.
I would like to have breakfast.
Please help me get dressed.
Can you read me a story?
Good night!
Call the doctor.
Please cover me with a blanket.
I want to draw something.
Can you read me a story?
I would like some tea.
Thank you for helping me.
Call the doctor.
I want to draw something.
Can you read me a story?
Good night!
I need some water.
Please fix my hair.
Please adjust my pillow.
Can you stay here with me?
Call the doctor.
Please cover me with a blanket.
I am feeling tired.
Good morning!
Can you help me write something?
Good morning!
Thank you for helping me.
I am feeling happy.
I am ready for bed.
Can we go for a walk?
I feel uncomfortable.
I would like some tea.
Good morning!
I need my medicine.
I feel a bit lonely.
I am feeling tired.
Good morning!
Can you help me write something?
Good night!
Please cover me with a blanket.
I feel a bit lonely.
Good morning!
I am feeling happy.
I would like to have breakfast.
Good night!
Can we go for a walk?
I am ready for bed.
I need to use the restroom.
I would like to have breakfast.
I would like to have breakfast.
Good night!
Can you help me write something?
Thank you for helping me.
I would like to have breakfast.
I would like to have breakfast.
Thank you for helping me.
I am ready for bed.
I would like some tea.
I need some water.
I am feeling tired.
Good night!
Can you read me a story?
Please fix my hair.
I want to talk to someone.
I need some water.
I want to talk to someone.
I feel uncomfortable.
I am ready for bed.
I am feeling tired.
Please adjust my pillow.
I feel uncomfortable.
I would like to have breakfast.
I want to talk to someone.
I need some water.
I want to talk to someone.
I need some water.
I need my medicine.
Can we go for a walk?
I want to talk to someone.
Thank you for helping me.
I want to draw something.
Please cover me with a blanket.
I want to draw something.
Please adjust my pillow.
Please cover me with a blanket.
I am feeling happy.
I want to draw something.
I am ready for bed.
Can we go for a walk?
Can you help me write something?
I feel a bit lonely.
Can we go for a walk?
I feel uncomfortable.
I would like some tea.
Can we go for a walk?
I would like some tea.
I would like to have breakfast.
I would like some tea.
I am feeling happy.
Can you help me write something?
Please fix my hair.
Please cover me with a blanket.
I am feeling happy.
I want to talk to someone.
Can you stay here with me?
I am feeling happy.
I would like some tea.
I want to talk to someone.
I need some water.
I want to draw something.
I would like some tea.
Can you help me write something?
Good morning!
Can you read me a story?
Thank you for helping me.
I am ready for bed.
I need some water.
Please cover me with a blanket.
I need some water.
I want to talk to someone.
I would like to have breakfast.
Please help me get dressed.
Can you stay here with me?
Good morning!
Can you stay here with me?
I need to use the restroom.
Good night!
I would like some tea.
Can we go for a walk?
Please help me get dressed.
I want to draw something.
I need to use the restroom.
I need my medicine.
I am feeling tired.
Please help me get dressed.
I am ready for bed.
I need some water.
Can you help me write something?
I want to talk to someone.
Please fix my hair.
Good night!
Can you check my temperature?
I feel a bit lonely.
Can you help me write something?
Can you help me write something?
Thank you for helping me.
Good night!
Good morning!
I feel a bit lonely.
Call the doctor.
Good morning!
I am ready for bed.
I need to use the restroom.
I am feeling tired.
Please cover me with a blanket.
Good night!
I am feeling happy.
Can you read me a story?
Call the doctor.
I am feeling happy.
Please adjust my pillow.
I need my medicine.
I want to talk to someone.
I feel a bit lonely.
I need my medicine.
I need to use the restroom.
Please adjust my pillow.
Can we go for a walk?
Please cover me with a blanket.
Call the doctor.
Good morning!
I would like to have breakfast.
Can you read me a story?
I am feeling tired.
I need some water.
I am ready for bed.
Call the doctor.
Can you read me a story?
Can you stay here with me?
Can we go for a walk?
I am feeling tired.
Please adjust my pillow.
I would like to have breakfast.
I feel uncomfortable.
Call the doctor.
I feel a bit lonely.
Thank you for helping me.
I need my medicine.
Can you check my temperature?
I feel uncomfortable.
I am feeling tired.
I want to draw something.
I am feeling tired.
Please cover me with a blanket.
Can we go for a walk?
I would like some tea.
Please fix my hair.
Please fix my hair.
I want to talk to someone.
Can you stay here with me?
Can you read me a story?
Call the doctor.
I want to talk to someone.
I need my medicine.
Thank you for helping me.
I am feeling happy.
Can you check my temperature?
Can you help me write something?
I need some water.
Please cover me with a blanket.
Can you read me a story?
Can we go for a walk?
I need to use the restroom.
I would like some tea.
Can we go for a walk?
I feel a bit lonely.
Can you read me a story?
I am feeling tired.
Can you help me write something?
Can we go for a walk?
Can you stay here with me?
Please help me get dressed.
I want to draw something.
I want to talk to someone.
Call the doctor.
Can you check my temperature?
I need some water.
Please adjust my pillow.
Can you help me write something?
I need to use the restroom.
I want to talk to someone.
Thank you for helping me.
Can you stay here with me?
Can you check my temperature?
I feel a bit lonely.
Can you check my temperature?
Please help me get dressed.
Call the doctor.
I would like to have breakfast.
Can you help me write something?
I would like some tea.
Please cover me with a blanket.
Can you help me write something?
Can we go for a walk?
Can you stay here with me?
Please help me get dressed.
I want to draw something.
I want to talk to someone.
Call the doctor.
Can you check my temperature?
I need some water.
Please adjust my pillow.
Can you help me write something?
I need to use the restroom.
I want to talk to someone.
Thank you for helping me.
Can you stay here with me?
Can you check my temperature?
I feel a bit lonely.
Can you check my temperature?
Please help me get dressed.
Call the doctor.
I would like to have breakfast.
Can you help me write something?
I would like some tea.
Please cover me with a blanket.
Can you help me write something?
Call the doctor.
I would like to have breakfast.
I feel a bit lonely.
Please adjust my pillow.
I feel uncomfortable.
I need some water.
I need my medicine.
I feel a bit lonely.
Good morning!
I need to use the restroom.
Good morning!
Good night!
I would like some tea.
I need some water.
Can you read me a story?
I need some water.
Good morning!
I want to draw something.
I would like to have breakfast.
I want to talk to someone.
Can we go for a walk?
Can you help me write something?
Please adjust my pillow.
I need to use the restroom.
Call the doctor.
Good morning!
I want to talk to someone.
Can you check my temperature?
Please help me get dressed.
I need to use the restroom.
I am feeling tired.
I am feeling happy.
I need to use the restroom.
Can you help me write something?
I am feeling tired.
Can you check my temperature?
I feel a bit lonely.
Please help me get dressed.
I am feeling happy.
Call the doctor.
Can we go for a walk?
I would like to have breakfast.
Can you help me write something?
I am feeling happy.
Please fix my hair.
I want to talk to someone.
Can we go for a walk?
Can you check my temperature?
I am feeling happy.
Please help me get dressed.
I need to use the restroom.
Thank you for helping me.
I want to talk to someone.
I feel uncomfortable.
I need my medicine.
I am feeling tired.
Can you read me a story?
I am feeling happy.
I want to draw something.
Can you help me write something?
Please fix my hair.
Can we go for a walk?
Good morning!
I would like some tea.
I want to draw something.
I need my medicine.
I need some water.
I need my medicine.
Good morning!
Can you help me write something?
Please fix my hair.
I would like to have breakfast.
Please fix my hair.
Can we go for a walk?
Good morning!
I need some water.
Can you read me a story?
Please fix my hair.
I would like to have breakfast.
Please help me get dressed.
Can you help me write something?
Can we go for a walk?
Good morning!
Please adjust my pillow.
Please fix my hair.
I would like to have breakfast.
I would like to have breakfast.
I want to talk to someone.
Please fix my hair.
Thank you for helping me.
Can you check my temperature?
I need my medicine.
Call the doctor.
I need my medicine.
Please help me get dressed.
Thank you for helping me.
I need some water.
I would like to have breakfast.
I feel uncomfortable.
I feel a bit lonely.
I am ready for bed.
Please adjust my pillow.
Can you stay here with me?
Can you help me write something?
Please adjust my pillow.
I feel a bit lonely.
Good morning!
Please cover me with a blanket.
I am feeling tired.
Can you read me a story?
I am feeling happy.
Thank you for helping me.
Please adjust my pillow.
I feel a bit lonely.
I want to draw something.
I feel uncomfortable.
I am feeling tired.
Please fix my hair.
I need my medicine.
Please fix my hair.
Call the doctor.
I would like to have breakfast.
I would like to have breakfast.
Please help me get dressed.
Can you read me a story?
Good night!
Call the doctor.
Please cover me with a blanket.
I want to draw something.
Can you read me a story?
I would like some tea.
Thank you for helping me.
Call the doctor.
I want to draw something.
Can you read me a story?
Good night!
I need some water.
Please fix my hair.
Please adjust my pillow.
Can you stay here with me?
Call the doctor.
Please cover me with a blanket.
I am feeling tired.
Good morning!
Can you help me write something?
Good morning!
Thank you for helping me.
I am feeling happy.
I am ready for bed.
Can we go for a walk?
I feel uncomfortable.
I would like some tea.
Good morning!
I need my medicine.
I feel a bit lonely.
I am feeling tired.
Good morning!
Can you help me write something?
Good night!
Please cover me with a blanket.
I feel a bit lonely.
Good morning!
I am feeling happy.
I would like to have breakfast.
Good night!
Can we go for a walk?
I am ready for bed.
I need to use the restroom.
I would like to have breakfast.
I would like to have breakfast.
Good night!
Can you help me write something?
Thank you for helping me.
I would like to have breakfast.
I would like to have breakfast.
Thank you for helping me.
I am ready for bed.
I would like some tea.
I need some water.
I am feeling tired.
Good night!
Can you read me a story?
Please fix my hair.
I want to talk to someone.
I need some water.
I want to talk to someone.
I feel uncomfortable.
I am ready for bed.
I am feeling tired.
Please adjust my pillow.
I feel uncomfortable.
I would like to have breakfast.
I want to talk to someone.
I need some water.
I want to talk to someone.
I need some water.
I need my medicine.
Can we go for a walk?
I want to talk to someone.
Thank you for helping me.
I want to draw something.
Please cover me with a blanket.
I want to draw something.
Please adjust my pillow.
Please cover me with a blanket.
I am feeling happy.
I want to draw something.
I am ready for bed.
Can we go for a walk?
Can you help me write something?
I feel a bit lonely.
Can we go for a walk?
I feel uncomfortable.
I would like some tea.
Can we go for a walk?
I would like some tea.
I would like to have breakfast.
I would like some tea.
I am feeling happy.
Can you help me write something?
Please fix my hair.
Please cover me with a blanket.
I am feeling happy.
I want to talk to someone.
Can you stay here with me?
I am feeling happy.
I would like some tea.
I want to talk to someone.
I need some water.
I want to draw something.
I would like some tea.
Can you help me write something?
Good morning!
Can you read me a story?
Thank you for helping me.
I am ready for bed.
I need some water.
Please cover me with a blanket.
I need some water.
I want to talk to someone.
I would like to have breakfast.
Please help me get dressed.
Can you stay here with me?
Good morning!
Can you stay here with me?
I need to use the restroom.
Good night!
I would like some tea.
Can we go for a walk?
Please help me get dressed.
I want to draw something.
I need to use the restroom.
I need my medicine.
I am feeling tired.
Please help me get dressed.
I am ready for bed.
I need some water.
Can you help me write something?
I want to talk to someone.
Please fix my hair.
Good night!
Can you check my temperature?
I feel a bit lonely.
Can you help me write something?
Can you help me write something?
Thank you for helping me.
Good night!
Good morning!
I feel a bit lonely.
Call the doctor.
Good morning!
I am ready for bed.
I need to use the restroom.
I am feeling tired.
Please cover me with a blanket.
Good night!
I am feeling happy.
Can you read me a story?
Call the doctor.
I am feeling happy.
Please adjust my pillow.
I need my medicine.
I want to talk to someone.
I feel a bit lonely.
I need my medicine.
I need to use the restroom.
Please adjust my pillow.
Can we go for a walk?
Please cover me with a blanket.
Call the doctor.
Good morning!
I would like to have breakfast.
Can you read me a story?
I am feeling tired.
I need some water.
I am ready for bed.
Call the doctor.
Can you read me a story?
Can you stay here with me?
Can we go for a walk?
I am feeling tired.
Please adjust my pillow.
I would like to have breakfast.
I feel uncomfortable.
Call the doctor.
I feel a bit lonely.
Thank you for helping me.
I need my medicine.
Can you check my temperature?
I feel uncomfortable.
I am feeling tired.
I want to draw something.
I am feeling tired.
Please cover me with a blanket.
Can we go for a walk?
I would like some tea.
Please fix my hair.
Please fix my hair.
I want to talk to someone.
Can you stay here with me?
Can you read me a story?
Call the doctor.
I want to talk to someone.
I need my medicine.
Thank you for helping me.
I am feeling happy.
Can you check my temperature?
Can you help me write something?
I need some water.
Please cover me with a blanket.
Can you read me a story?
Can we go for a walk?
I need to use the restroom.
I would like some tea.
Can we go for a walk?
I feel a bit lonely.
Can you read me a story?
I am feeling tired.
Can you help me write something?
I would like to have breakfast.
I want to talk to someone.
I feel a bit lonely.
Can you check my temperature?
I need my medicine.
I would like to have breakfast.
I am feeling tired.
Can you stay here with me?
I feel uncomfortable.
Please adjust my pillow.
Can you read me a story?
Please cover me with a blanket.
I am feeling happy.
I am feeling happy.
Can you stay here with me?
Can you read me a story?
I would like some tea.
I am feeling tired.
Please cover me with a blanket.
I want to talk to someone.
Can you check my temperature?
I am ready for bed.
Can you stay here with me?
Please help me get dressed.
Can you help me write something?
Please help me get dressed.
Please cover me with a blanket.
I need to use the restroom.
I want to draw something.
Can we go for a walk?
Good morning!
Can we go for a walk?
I feel uncomfortable.
Good morning!
Please cover me with a blanket.
I feel a bit lonely.
Good morning!
Thank you for helping me.
I need my medicine.
Can you read me a story?
I need my medicine.
Can you check my temperature?
Please fix my hair.
Please adjust my pillow.
I feel uncomfortable.
I would like some tea.
I am feeling happy.
Please cover me with a blanket.
I would like some tea.
Can you check my temperature?
Can you check my temperature?
I feel uncomfortable.
I am ready for bed.
Can you check my temperature?
I want to draw something.
I am ready for bed.
I feel uncomfortable.
I am feeling happy.
I need my medicine.
I need my medicine.
I feel uncomfortable.
I want to draw something.
I would like to have breakfast.
I need some water.
I want to talk to someone.
Call the doctor.
Good morning!
I need to use the restroom.
Good night!
Thank you for helping me.
Can you read me a story?
I am feeling tired.
I want to talk to someone.
I want to draw something.
Please adjust my pillow.
Thank you for helping me.
Can you check my temperature?
Can you help me write something?
Thank you for helping me.
I would like some tea.
I want to draw something.
Please cover me with a blanket.
Can you stay here with me?
I feel a bit lonely.
Please help me get dressed.
Good morning!
I feel uncomfortable.
Please help me get dressed.
I want to draw something.
Can you read me a story?
I feel a bit lonely.
Call the doctor.
I am feeling happy.
Can you help me write something?
I am feeling tired.
Call the doctor.
I am ready for bed.
Please help me get dressed.
Please adjust my pillow.
I would like some tea.
I would like some tea.
I would like to have breakfast.
Can you stay here with me?
Can we go for a walk?
I need to use the restroom.
Please cover me with a blanket.
I want to talk to someone.
I would like to have breakfast.
I am ready for bed.
Can we go for a walk?
Good night!
I am feeling tired.
Good morning!
I feel uncomfortable.
I need my medicine.
Can you help me write something?
I feel uncomfortable.
I am feeling tired.
Please adjust my pillow.
Can you help me write something?
Please help me get dressed.
Please adjust my pillow.
Can you stay here with me?
Can you help me write something?
Can you help me write something?
Can you read me a story?
I would like to have breakfast.
I would like to have breakfast.
I need my medicine.
Call the doctor.
Call the doctor.
Can we go for a walk?
I am feeling tired.
Please help me get dressed.
Call the doctor.
Can you check my temperature?
Please fix my hair.
I am ready for bed.
Can you help me write something?
I am feeling tired.
Please cover me with a blanket.
I would like some tea.
Please help me get dressed.
I am feeling tired.
I would like to have breakfast.
I am ready for bed.
I would like to have breakfast.
I would like some tea.
I want to talk to someone.
I feel uncomfortable.
Thank you for helping me.
I am ready for bed.
Thank you for helping me.
I am ready for bed.
I want to talk to someone.
Call the doctor.
Can you read me a story?
Call the doctor.
Please adjust my pillow.
Please fix my hair.
I am feeling happy.
I am ready for bed.
Can we go for a walk?
I am feeling happy.
Can you stay here with me?
I need to use the restroom.
Can you stay here with me?
Thank you for helping me.
Call the doctor.
Please adjust my pillow.
Can you help me write something?
I would like to have breakfast.
I feel a bit lonely.
Can you read me a story?
Good morning!
Good night!
I want to draw something.
Can you check my temperature?
Can we go for a walk?
I feel uncomfortable.
Please cover me with a blanket.
Good night!
Can you stay here with me?
Thank you for helping me.
I am feeling happy.
Please adjust my pillow.
I am ready for bed.
Can you help me write something?
I am ready for bed.
I am feeling tired.
Please help me get dressed.
I would like to have breakfast.
Good night!
Can we go for a walk?
Please adjust my pillow.
Can you help me write something?
Good night!
Please cover me with a blanket.
Please help me get dressed.
Can you help me write something?
I would like some tea.
Good night!
I want to draw something.
I want to draw something.
Call the doctor.
Can you read me a story?
I am ready for bed.
Call the doctor.
Can you stay here with me?
Can you stay here with me?
I am feeling happy.
Please fix my hair.
I want to talk to someone.
I need to use the restroom.
I am feeling tired.
I am feeling happy.
Please help me get dressed.
Please fix my hair.
Can you stay here with me?
Can you check my temperature?
I need my medicine.
I am ready for bed.
I would like some tea.
Please cover me with a blanket.
Thank you for helping me.
Can you help me write something?
I would like to have breakfast.
I would like to have breakfast.
Please cover me with a blanket.
Can you stay here with me?
Thank you for helping me.
I am ready for bed.
Thank you for helping me.
I am feeling tired.
I am feeling tired.
I need to use the restroom.
I feel a bit lonely.
Good night!
Thank you for helping me.
Call the doctor.
Can you stay here with me?
I need my medicine.
I need to use the restroom.
Please cover me with a blanket.
Call the doctor.
Call the doctor.
I want to draw something.
Can you help me write something?
I am feeling happy.
I am feeling tired.

"""

import tensorflow as tf
import numpy as np
from tensorflow.keras.preprocessing.text import Tokenizer

tokenizer = Tokenizer()

tokenizer.fit_on_texts([faqs])

len(tokenizer.word_index)

input_sequences = []
for sentence in faqs.split('\n'):
  tokenized_sentence = tokenizer.texts_to_sequences([sentence])[0]

  for i in range(1,len(tokenized_sentence)):
    input_sequences.append(tokenized_sentence[:i+1])

input_sequences

max_len = max([len(x) for x in input_sequences])

from tensorflow.keras.preprocessing.sequence import pad_sequences
padded_input_sequences = pad_sequences(input_sequences, maxlen = max_len, padding='pre')

padded_input_sequences

X = padded_input_sequences[:,:-1]

y = padded_input_sequences[:,-1]



from tensorflow.keras.utils import to_categorical
y = to_categorical(y,num_classes=283)


from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Embedding, LSTM, Dense

model = Sequential()
model.add(Embedding(283, 100))
model.add(LSTM(150))
model.add(Dense(283, activation='softmax'))

model.compile(loss='categorical_crossentropy', optimizer='adam',metrics=['accuracy'])

model.summary()

model.fit(X,y,epochs=100)

import numpy as np
from keras.preprocessing.sequence import pad_sequences

# Example input
text = "I"

# Tokenize input text
token_text = tokenizer.texts_to_sequences([text])[0]

# Pad it
padded_token_text = pad_sequences([token_text], maxlen=56, padding='pre')

# Predict the next word probabilities
prediction = model.predict(padded_token_text, verbose=0)[0]

# Get the top N most probable next words
top_n = 10  # you can choose how many suggestions you want
top_indices = prediction.argsort()[-top_n:][::-1]  # sort and pick top N

# Map indices back to words
index_to_word = {index: word for word, index in tokenizer.word_index.items()}

# List of next possible words
next_possible_words = [index_to_word.get(i, '') for i in top_indices]

print(f"Possible next words after '{text}':")
for word in next_possible_words:
    print("-", word)

tokenizer.word_index
model.save("lstm_model.keras")


import time
import numpy as np
from fastapi import FastAPI
from pydantic import BaseModel
from fastapi.middleware.cors import CORSMiddleware
from keras.preprocessing.sequence import pad_sequences
import uvicorn
import tensorflow as tf



# ðŸš€ Create FastAPI app
app = FastAPI()


app.add_middleware(
    CORSMiddleware,
    allow_origins=["*"],  # allow all origins
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)

class InputText(BaseModel):
    text: str
    steps: int = 10  # optional: number of words to generate

@app.post("/generate")
async def generate_text(input: InputText):
    text = input.text
    token_text = tokenizer.texts_to_sequences([text])[0]
    padded_token_text = pad_sequences([token_text], maxlen=56, padding='pre')
    prediction = model.predict(padded_token_text, verbose=0)[0]

    top_n = input.steps  # how many suggestions user wants
    top_indices = prediction.argsort()[-top_n:][::-1]  # get top N indices

    # Map indices to words
    index_to_word = {index: word for word, index in tokenizer.word_index.items()}
    next_possible_words = [index_to_word.get(i, '') for i in top_indices]

    return {"generate": next_possible_words}
